---
date: 2025-10-10 09:15:30
title: 16-tapabelåº•å±‚åŸç† <TkTitleTag type="vp-primary" text="ä¼˜è´¨" position="right" />
permalink: /pages/16-tapabelåº•å±‚åŸç†
categories:
  - Webpack
coverImg: /img/webpack.jpeg
tags:
  - babelçš„è¿›é˜¶ä½¿ç”¨

---
# Tapable ä¸ Webpack åº•å±‚åŸç†

## 1. Tapable ä½¿ç”¨ä»‹ç»

`tapable` æ˜¯ä¸€ä¸ªè½»é‡çº§çš„ JavaScript åº“ï¼Œå®ƒæä¾›äº†ä¸€ä¸ª**å¼ºå¤§çš„å‘å¸ƒ/è®¢é˜…ï¼ˆäº‹ä»¶ï¼‰æœºåˆ¶**ï¼Œç”¨äºæ„å»ºæ’ä»¶åŒ–çš„æ¶æ„ã€‚

`Webpack` çš„æ•´ä¸ªæ’ä»¶ç³»ç»Ÿéƒ½åŸºäº `tapable` æ„å»ºï¼Œç†è§£å®ƒå¯¹äºæ·±å…¥æŒæ¡ `Webpack` **å·¥ä½œåŸç†ã€ç¼–å†™é«˜è´¨é‡çš„è‡ªå®šä¹‰æ’ä»¶è‡³å…³é‡è¦**ã€‚

ä½ å¯ä»¥æŠŠ `tapable` çœ‹ä½œæ˜¯ä¸€ä¸ªå¯æ‰©å±•çš„**äº‹ä»¶ç®¡ç†å™¨**ã€‚å®ƒå…è®¸ä½ åœ¨ä»£ç çš„ç‰¹å®š**"ç”Ÿå‘½å‘¨æœŸç‚¹"**å®šä¹‰**"é’©å­ï¼ˆHooksï¼‰"**ï¼Œå…¶ä»–æ¨¡å—æˆ–æ’ä»¶å¯ä»¥**"æŒ‚è½½ï¼ˆTapï¼‰"**åˆ°è¿™äº›é’©å­ä¸Šï¼Œä»¥æ³¨å…¥è‡ªå®šä¹‰é€»è¾‘ã€‚å½“è¿™äº›é’©å­è¢«**"è°ƒç”¨ï¼ˆCallï¼‰"**æ—¶ï¼Œæ‰€æœ‰æŒ‚è½½çš„å‡½æ•°éƒ½ä¼šæŒ‰ç‰¹å®šè§„åˆ™æ‰§è¡Œã€‚

## 2. æ ¸å¿ƒæ¦‚å¿µ

ç†è§£ `tapable` ä¸»è¦æ¶‰åŠä»¥ä¸‹ä¸‰ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼š

### 2.1 é’©å­ (Hooks)

é’©å­æ˜¯ `tapable` çš„æ ¸å¿ƒã€‚å®ƒä»¬æ˜¯ç‰¹å®šäº‹ä»¶çš„**å ä½ç¬¦**ï¼Œä»£è¡¨äº†ç¨‹åºæ‰§è¡Œæµç¨‹ä¸­çš„æŸä¸ªå¯æ‰©å±•ç‚¹ã€‚æ¯ä¸ªé’©å­éƒ½æ˜¯ `tapable` åº“ä¸­ä¸åŒç±»å‹é’©å­ç±»ï¼ˆå¦‚ `SyncHook`ã€`AsyncParallelHook`ï¼‰çš„å®ä¾‹ã€‚

é’©å­å®šä¹‰äº†ï¼š

- å¯ä»¥ä¼ é€’ç»™å›è°ƒå‡½æ•°çš„å‚æ•°
- å›è°ƒå‡½æ•°çš„æ‰§è¡Œæ–¹å¼ï¼ˆ**åŒæ­¥/å¼‚æ­¥ã€ä¸²è¡Œ/å¹¶è¡Œã€æ˜¯å¦å¯ä¸­æ–­ç­‰**ï¼‰

### 2.2 æŒ‚è½½ (Tapping)

æŒ‚è½½æ˜¯æŒ‡å°†ä¸€ä¸ª**å›è°ƒå‡½æ•°**ï¼ˆé€šå¸¸æ˜¯æ’ä»¶çš„æŸä¸ªæ–¹æ³•ï¼‰æ³¨å†Œåˆ°ç‰¹å®šçš„é’©å­ä¸Šã€‚å½“é’©å­è¢«è§¦å‘æ—¶ï¼Œè¿™äº›æŒ‚è½½çš„å‡½æ•°å°±ä¼šè¢«æ‰§è¡Œã€‚

æ ¹æ®é’©å­çš„ç±»å‹ï¼ŒæŒ‚è½½æ–¹å¼ä¹Ÿæœ‰æ‰€ä¸åŒï¼š

- `.tap(pluginName, handler)`: ç”¨äº**åŒæ­¥**å›è°ƒ
- `.tapAsync(pluginName, handler)`: ç”¨äº**å¼‚æ­¥**å›è°ƒï¼ˆå›è°ƒå‡½æ•°æ–¹å¼ï¼‰
- `.tapPromise(pluginName, handler)`: ç”¨äº**å¼‚æ­¥**å›è°ƒï¼ˆè¿”å› Promiseï¼‰

å…¶ä¸­ `pluginName` é€šå¸¸æ˜¯æ’ä»¶çš„åç§°ï¼Œç”¨äºè°ƒè¯•å’Œé”™è¯¯æŠ¥å‘Šã€‚

### 2.3 è°ƒç”¨ (Calling) / è§¦å‘ (Emitting)

è°ƒç”¨æ˜¯æŒ‡åœ¨ç¨‹åºæ‰§è¡Œåˆ°**ç‰¹å®šç”Ÿå‘½å‘¨æœŸç‚¹æ—¶**ï¼Œä¸»åŠ¨è§¦å‘æŸä¸ªé’©å­ï¼Œä½¿å¾—æ‰€æœ‰å·²æŒ‚è½½åˆ°è¯¥é’©å­ä¸Šçš„å›è°ƒå‡½æ•°æŒ‰ç…§é’©å­**ç±»å‹å®šä¹‰çš„è§„åˆ™æ‰§è¡Œ**ã€‚

ä¸åŒçš„è°ƒç”¨æ–¹å¼ï¼š

- `.call(...args)`: ç”¨äº**åŒæ­¥**é’©å­ï¼Œä¼ å…¥å‚æ•°å¹¶åŒæ­¥æ‰§è¡Œæ‰€æœ‰æŒ‚è½½çš„å‡½æ•°
- `.callAsync(...args, callback)`: ç”¨äº**å¼‚æ­¥**é’©å­ï¼ˆå›è°ƒæ–¹å¼ï¼‰ï¼Œå½“æ‰€æœ‰å¼‚æ­¥ä»»åŠ¡å®Œæˆåï¼Œæ‰§è¡Œæœ€ç»ˆçš„ `callback`
- `.promise(...args)`: ç”¨äº**å¼‚æ­¥**é’©å­ï¼ˆPromise æ–¹å¼ï¼‰ï¼Œè¿”å›ä¸€ä¸ª `Promise`ï¼Œå½“æ‰€æœ‰å¼‚æ­¥ä»»åŠ¡å®Œæˆå `resolved`

## 3. é’©å­ç±»å‹è¯¦è§£

### 3.1 å‰ç½®çŸ¥è¯†

`tapable` æä¾›äº†å¤šç§é’©å­ç±»å‹ï¼Œä»¥é€‚åº”ä¸åŒçš„æ‰§è¡Œéœ€æ±‚ï¼š

![é’©å­ç±»å‹æ¦‚è§ˆ](https://pic1.zhimg.com/80/v2-83b43510929c0071aec2d9dbd1c81294_1420w.png)

**åŒæ­¥å’Œå¼‚æ­¥çš„åŒºåˆ†ï¼š**

- ä»¥ `sync` å¼€å¤´çš„ï¼Œæ˜¯åŒæ­¥çš„ Hook
- ä»¥ `async` å¼€å¤´çš„ï¼Œæ˜¯å¼‚æ­¥çš„ Hook

**å…¶ä»–ç±»åˆ«è¯´æ˜ï¼š**
1. `Bail` (**ç†”æ–­**)ï¼š å½“è¿”å›å€¼æ˜¯é `undefined` çš„ç»“æœæ—¶å°±ç«‹å³åœæ­¢ï¼Œä¸ä¼šæ‰§è¡Œåç»­çš„äº‹ä»¶è§¦å‘ã€‚

2. `Loop` (**å¾ªç¯**)ï¼š å½“è¿”å›å€¼ä¸ºé `undefined` æ—¶ï¼Œå°±ä¼šè¿›è¡Œå¾ªç¯ï¼Œæ•´ä¸ªå¾ªç¯å°±å¿…é¡»ä»ç¬¬ä¸€ä¸ªè®¢é˜…è€…é‚£é‡Œä»å¤´å†æ¥ä¸€éï¼Œå½“è¿”å›å€¼ä¸º undefined å°±é€€å‡ºäº‹ä»¶ã€‚

3. `Waterfall` (**ç€‘å¸ƒæµ**)ï¼š ä¸€å®šä¼šæ‰§è¡Œå®Œæ‰€æœ‰è®¢é˜…è€…ã€‚

   - è¿”å›é `undefined`ï¼šç”¨è¿™ä¸ªè¿”å›å€¼æ›¿æ¢ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œä¼ ç»™ä¸‹ä¸€ä¸ªã€‚

   - è¿”å› `undefined`ï¼šä¿æŒç¬¬ä¸€ä¸ªå‚æ•°ä¸å˜ï¼Œä¼ ç»™ä¸‹ä¸€ä¸ªã€‚

4. `Parallel` (**å¹¶è¡Œ**)ï¼š ï¼ˆä¸»è¦æŒ‡å¼‚æ­¥ï¼‰åŒæ—¶å¯åŠ¨æ‰€æœ‰è®¢é˜…è€…ï¼Œç­‰å¾…å…¨éƒ¨å®Œæˆå æ‰æ‰§è¡Œæœ€ç»ˆå›è°ƒ

5. `Series` (**ä¸²è¡Œ**)ï¼š ï¼ˆä¸»è¦æŒ‡å¼‚æ­¥ï¼‰ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°æ‰§è¡Œã€‚å¿…é¡»ç­‰ä¸Šä¸€ä¸ªå®Œæˆå ä¸‹ä¸€ä¸ªæ‰èƒ½å¼€å§‹

### 3.2 åŒæ­¥é’©å­

#### 3.2.1 SyncHook

**ç‰¹ç‚¹ï¼š** æœ€ç®€å•çš„é’©å­ã€‚æ‰€æœ‰æŒ‚è½½çš„å‡½æ•°ä¼šæŒ‰æ³¨å†Œé¡ºåº**ä¾æ¬¡æ‰§è¡Œ**ã€‚**æ— è¿”å›å€¼**ï¼Œå³ä¾¿æ˜¯å‡½æ•°è¿”å›äº†**å€¼ä¹Ÿä¼šè¢«å¿½ç•¥**ã€‚

**ç”¨ä¾‹ï¼š** é€šçŸ¥äº‹ä»¶å‘ç”Ÿï¼Œä¸å…³å¿ƒè¿”å›å€¼ï¼Œä¾‹å¦‚ `Webpack` ä¸­çš„ `done`ï¼ˆç¼–è¯‘å®Œæˆï¼‰æˆ– `beforeRun` é’©å­ã€‚

```js
const tabable = require('tapable');
class Compiler {
  constructor() {
    this.hooks = {
      SyncHook: new tabable.SyncHook(['name', 'age']),
    };
  }
}

const c = new Compiler();
c.hooks.SyncHook.tap('SyncHook1', (name, age) => {
  console.log(name, age); // zhangsan 20
  return 1;
});
c.hooks.SyncHook.tap('SyncHook2', (name, age) => {
  console.log(name, age); // zhangsan 20
  return 23;
});

const val = c.hooks.SyncHook.call('zhangsan', 20);
console.log('val', val); // undefined
```

#### 3.2.2 SyncBailHook

**ç‰¹ç‚¹ï¼š** åœ¨ `SyncBailHook` çš„ä¸–ç•Œé‡Œï¼Œ**undefined** æ„å‘³ç€"**ä¸€åˆ‡æ­£å¸¸ï¼Œè¯·ç»§ç»­**"ã€‚è€Œä»»ä½•**é undefined çš„è¿”å›å€¼**åˆ™è¢«è§†ä¸ºä¸€ä¸ª"åœæ­¢ä¿¡å·"ï¼Œä¼š**ç«‹å³ä¸­æ–­æ‰§è¡Œé“¾æ¡**ã€‚

**ç”¨ä¾‹ï¼š** æ ¡éªŒé€»è¾‘ï¼Œå¦‚æœæŸä¸ªæ’ä»¶å‘ç°ä¸ç¬¦åˆæ¡ä»¶ï¼Œ**å¯ä»¥ç«‹å³ä¸­æ­¢åç»­å¤„ç†**ã€‚

```js
const tabable = require('tapable');
class Compiler {
  constructor() {
    this.hooks = {
      SyncBailHook: new tabable.SyncBailHook(['name', 'age']),
    };
  }
}

const c = new Compiler();
c.hooks.SyncBailHook.tap('SyncBailHook1', (name, age) => {
  console.log(name, age); // zhangsan 20
});
c.hooks.SyncBailHook.tap('SyncBailHook2', (name, age) => {
  console.log(name, age); // zhangsan 20
  return 'SyncBailHook2';
});
// è¿”å›é undefined çš„å€¼ï¼Œé‚£ä¹ˆåç»­çš„å‡½æ•°å°†ä¸å†æ‰§è¡Œ
c.hooks.SyncBailHook.tap('SyncBailHook3', (name, age) => {
  console.log(name, age);
});

const returnedValue = c.hooks.SyncBailHook.call('zhangsan', 20);
console.log('returnedValue', returnedValue); // SyncBailHook2
```

#### 3.2.3 SyncWaterfallHook

**ç‰¹ç‚¹ï¼š** "ç€‘å¸ƒ"é’©å­ã€‚ä¸Šä¸€ä¸ªæŒ‚è½½å‡½æ•°çš„**è¿”å›å€¼ä¼šä½œä¸ºä¸‹ä¸€ä¸ªå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°**ã€‚ç¬¬ä¸€ä¸ªæŒ‚è½½å‡½æ•°çš„å‚æ•°ç”± `.call()` æ–¹æ³•ä¼ å…¥ã€‚

**æ³¨æ„ï¼š** å¦‚æœæœ‰å¤šä¸ªå‡½æ•°ï¼Œ**åªæœ‰ç¬¬ä¸€ä¸ªå‡½æ•°å­˜åœ¨è¿”å›å€¼ï¼Œåé¢å‡½æ•°éƒ½æ²¡æœ‰è¿”å›å€¼ï¼Œè¿™ä¸ªæ—¶å€™ç¬¬ä¸€ä¸ªå‡½æ•°è¿”å›å€¼ï¼Œä¼šä½œä¸ºæœ€ç»ˆè¿”å›å€¼**ã€‚

```js
const tabable = require('tapable');
class Compiler {
  constructor() {
    this.hooks = {
      SyncWaterfallHook: new tabable.SyncWaterfallHook(['name', 'age']),
    };
  }
}

const c = new Compiler();
c.hooks.SyncWaterfallHook.tap('1', (name, age) => {
  console.log(name, age);
});
c.hooks.SyncWaterfallHook.tap('2', (name, age) => {
  console.log(name, age);
  return 'SyncWaterfallHook2';
});
c.hooks.SyncWaterfallHook.tap('3', (name, age) => {
  console.log('æ¥æ”¶ä¸Šä¸€ä¸ªè¿”å›å€¼', name, age); //  SyncWaterfallHook2 20
});
// æ¥æ”¶çš„è¿”å›å€¼å°±æ˜¯ SyncWaterfallHook2
const returnedValue = c.hooks.SyncWaterfallHook.call('zhangsan', 20);
console.log('returnedValue', returnedValue); // SyncWaterfallHook2
```

#### 3.2.4 SyncLoopHook

**ç‰¹ç‚¹ï¼š** "å¾ªç¯"é’©å­ã€‚å¦‚æœä»»ä½•æŒ‚è½½çš„å‡½æ•°**è¿”å›é `undefined` çš„å€¼**ï¼Œè¯¥å‡½æ•°ä¼š**å†æ¬¡æ‰§è¡Œ**ï¼Œç›´åˆ°è¿”å› `undefined`ã€‚æ­¤åï¼Œé’©å­ä¼šç»§ç»­æ‰§è¡Œä¸‹ä¸€ä¸ªæŒ‚è½½å‡½æ•°ï¼ˆ**å¦‚æœå­˜åœ¨**ï¼‰ã€‚

**æ ¸å¿ƒè§„åˆ™ï¼š** åªè¦è¿™ä¸€è½®å¾ªç¯é‡Œï¼Œæœ‰ä»»ä½•ä¸€ä¸ªè®¢é˜…è€…è¿”å›äº†é `undefined` çš„å€¼ï¼Œæ•´ä¸ªå¾ªç¯å°±å¿…é¡»ä»ç¬¬ä¸€ä¸ªè®¢é˜…è€…é‚£é‡Œä»å¤´å†æ¥ä¸€éã€‚

```js
const tabable = require('tapable');
class Compiler {
  constructor() {
    this.hooks = {
      SyncLoopHook: new tabable.SyncLoopHook(['name', 'age']),
    };
  }
}

const c = new Compiler();
let count = 0;
let count1 = 0;

c.hooks.SyncLoopHook.tap('SyncHook1', (name, age) => {
  count++;
  if (count < 3) {
    console.log('æ‰§è¡ŒSyncHook1');
    return true;
  }
  console.log('SyncHook1', name, age);
});
c.hooks.SyncLoopHook.tap('SyncHook2', (name, age) => {
  count1++;
  if (count1 < 5) {
    console.log('æ‰§è¡ŒSyncHook2');
    return true;
  }
  console.log('SyncHook2', name, age);
});

c.hooks.SyncLoopHook.call('zhangsan', 20);
// SyncHook1 ä¸€å…±æ‰§è¡Œäº† 7 æ¬¡, SyncHook2 ä¸€å…±æ‰§è¡Œäº† 5 æ¬¡ã€‚
console.log(`SyncHook1 ä¸€å…±æ‰§è¡Œäº† ${count} æ¬¡, SyncHook2 ä¸€å…±æ‰§è¡Œäº† ${count1} æ¬¡ã€‚`);
```

è™½ç„¶ `SyncHook1` åœ¨ `count` ç­‰äº 3 çš„æ—¶å€™å°±è¿”å›äº† `undefined`ï¼Œä½†æ˜¯ç”±äº `SyncHook2` ä¸­è¿”å›å€¼å¦‚æœæœ‰**é undefined è¿”å›å€¼**ï¼Œæ•´ä¸ªå¾ªç¯éƒ½ä¼šä»**ç¬¬ä¸€ä¸ªè®¢é˜…è€…å‡½æ•°é‡æ–°æ‰§è¡Œ**ã€‚

#### 3.2.5 åŒæ­¥é’©å­æ€»ç»“

1. **SyncHookï¼ˆåŒæ­¥é’©å­ï¼‰**
   - **ç‰¹ç‚¹**: æœ€ç®€å•çš„ä¸€ç§ï¼Œåƒä¸€ä¸ª"å¹¿æ’­ç«™" ğŸ“¢
   - **è¡Œä¸º**: è§¦å‘åï¼Œä¼šæŒ‰ç…§æ³¨å†Œé¡ºåºï¼Œ**ä¸æ¼æ‰ä»»ä½•ä¸€ä¸ª**åœ°æ‰§è¡Œæ‰€æœ‰è®¢é˜…è€…ï¼ˆtapsï¼‰ã€‚**å®ƒä¸å…³å¿ƒè®¢é˜…è€…çš„è¿”å›å€¼**

2. **SyncBailHookï¼ˆåŒæ­¥ç†”æ–­é’©å­ï¼‰**
   - **ç‰¹ç‚¹**: åƒä¸€ä¸ªå¸¦æœ‰"ç´§æ€¥åœæ­¢"æŒ‰é’®çš„è´¨æ£€æµæ°´çº¿ ğŸ›‘
   - **è¡Œä¸º**: ä¾æ¬¡æ‰§è¡Œè®¢é˜…è€…ï¼Œä½†åªè¦æœ‰**ä»»ä½•ä¸€ä¸ª**è®¢é˜…è€…è¿”å›äº†**é `undefined`** çš„å€¼ï¼Œå®ƒå°±ä¼š**ç«‹å³"ç†”æ–­"**ï¼Œ**åœæ­¢**æ‰§è¡Œåç»­çš„**æ‰€æœ‰è®¢é˜…è€…**

3. **SyncWaterfallHookï¼ˆåŒæ­¥ç€‘å¸ƒé’©å­ï¼‰**
   - **ç‰¹ç‚¹**: åƒä¸€ä¸ª"åŠ å·¥æµæ°´çº¿" ğŸ’§
   - **è¡Œä¸º**: ä¸Šä¸€ä¸ªè®¢é˜…è€…çš„**è¿”å›å€¼**ï¼Œä¼šæˆä¸ºä¸‹ä¸€ä¸ªè®¢é˜…è€…çš„**ç¬¬ä¸€ä¸ªå‚æ•°**ã€‚æ•°æ®å°±è¿™æ ·è¢«ä¸€æ­¥æ­¥åŠ å·¥å’Œä¼ é€’ä¸‹å»

4. **SyncLoopHookï¼ˆåŒæ­¥å¾ªç¯é’©å­ï¼‰**
   - **ç‰¹ç‚¹**: æœ€"æ‰§ç€"çš„ä¸€ä¸ªï¼Œåƒä¸€ä¸ª"æ°¸ä¸æ”¾å¼ƒçš„ç¼–è¯‘å™¨" ğŸ”
   - **è¡Œä¸º**: åªè¦æœ‰ä»»ä½•ä¸€ä¸ªè®¢é˜…è€…è¿”å›äº†**é `undefined`** çš„å€¼ï¼Œæ•´ä¸ªæ‰§è¡Œæµç¨‹å°±ä¼š**ä»å¤´å¼€å§‹**ï¼Œé‡æ–°æ‰§è¡Œæ‰€æœ‰è®¢é˜…è€…ã€‚ç›´åˆ°æŸä¸€è½®ï¼Œæ‰€æœ‰è®¢é˜…è€…éƒ½è¿”å› `undefined` ä¸ºæ­¢

### 3.3 å¼‚æ­¥é’©å­

åœ¨ `Webpack` è¿™æ ·çš„å·¥å…·é‡Œï¼Œ**å¼‚æ­¥æ“ä½œéå¸¸æ™®é**ã€‚æ¯”å¦‚ï¼Œ**Webpack éœ€è¦ä»ç¡¬ç›˜è¯»å–æºæ–‡ä»¶**ï¼Œæˆ–è€…æ’ä»¶å¯èƒ½éœ€è¦è¯·æ±‚ç½‘ç»œèµ„æºï¼Œè¿™äº›éƒ½ä¸èƒ½ç¬é—´å®Œæˆã€‚å¦‚æœç”¨**åŒæ­¥çš„æ–¹å¼**å»ç­‰ï¼Œ**æ•´ä¸ªæ‰“åŒ…è¿‡ç¨‹å°±ä¼šè¢«å¡ä½**ï¼Œæ•ˆç‡ä¼šéå¸¸ä½ã€‚

å¼‚æ­¥é’©å­å’ŒåŒæ­¥é’©å­æœ€å¤§çš„ä¸åŒåœ¨äºï¼š

- è§¦å‘é’©å­çš„æ–¹æ³•ä¸å†æ˜¯ `.call()`ï¼Œè€Œæ˜¯ `.callAsync()` æˆ– `.promise()`
- æŒ‚è½½çš„æ–¹æ³•ä¸å†æ˜¯ `.tap()`ï¼Œè€Œæ˜¯ `.tapAsync()` æˆ– `.tapPromise()`

#### 3.3.1 AsyncSeriesHook

å…ˆä»å’Œ `SyncHook` æœ€åƒçš„ `AsyncSeriesHook` å¼€å§‹ã€‚"Series" ä¾ç„¶æ˜¯"ä¸²è¡Œ"çš„æ„æ€ï¼Œå®ƒä¼šç¡®ä¿å¼‚æ­¥ä»»åŠ¡ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°æ‰§è¡Œã€‚

æˆ‘ä»¬è®¢é˜…ï¼ˆ`.tapAsync()`ï¼‰çš„å‡½æ•°ä¼šé¢å¤–æ”¶åˆ°ä¸€ä¸ª `callback` å‚æ•°ã€‚**ä½ å¿…é¡»åœ¨ä½ çš„å¼‚æ­¥ä»»åŠ¡å®Œæˆåï¼Œæ‰‹åŠ¨è°ƒç”¨è¿™ä¸ª `callback` å‡½æ•°**ï¼Œè¿™æ · `AsyncSeriesHook` **æ‰çŸ¥é“å¯ä»¥å¼€å§‹ä¸‹ä¸€ä¸ªä»»åŠ¡äº†**ã€‚

```js
const { AsyncSeriesHook } = require("tapable");

// 1. åˆ›å»ºä¸€ä¸ªå¼‚æ­¥ä¸²è¡Œé’©å­
const fileProcessingHook = new AsyncSeriesHook(["file"]);

console.log("å‡†å¤‡å¼€å§‹å¤„ç†æ–‡ä»¶...");

// 2. è®¢é˜…é’©å­
// æ³¨æ„ tapAsyncï¼Œå¹¶ä¸”å›è°ƒå‡½æ•°é‡Œå¤šäº†ä¸€ä¸ª callback å‚æ•°
fileProcessingHook.tapAsync("FileReaderPlugin", (file, callback) => {
  console.log(`å¼€å§‹è¯»å– ${file}...`);
  // æ¨¡æ‹Ÿä¸€ä¸ªè€—æ—¶ 1 ç§’çš„å¼‚æ­¥è¯»å–æ“ä½œ
  setTimeout(() => {
    console.log(`${file} è¯»å–å®Œæ¯•ï¼`);
    callback(); // <-- ä»»åŠ¡å®Œæˆï¼Œè°ƒç”¨ callback é€šçŸ¥é’©å­
  }, 1000);
});

fileProcessingHook.tapAsync("FileArchiverPlugin", (file, callback) => {
  console.log(`å¼€å§‹å‹ç¼© ${file}...`);
  // æ¨¡æ‹Ÿä¸€ä¸ªè€—æ—¶ 0.5 ç§’çš„å¼‚æ­¥å‹ç¼©æ“ä½œ
  setTimeout(() => {
    console.log(`${file} å‹ç¼©å®Œæ¯•ï¼`);
    callback(); // <-- ä»»åŠ¡å®Œæˆï¼Œè°ƒç”¨ callback
  }, 500);
});

// 3. è§¦å‘é’©å­
// ä½¿ç”¨ callAsyncï¼Œå®ƒçš„æœ€åä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ª"æœ€ç»ˆå›è°ƒ"ï¼Œåœ¨æ‰€æœ‰ä»»åŠ¡éƒ½å®Œæˆåæ‰§è¡Œ
fileProcessingHook.callAsync("styles.css", () => {
  console.log("æ‰€æœ‰æ–‡ä»¶å¤„ç†ä»»åŠ¡å·²å…¨éƒ¨å®Œæˆï¼");
});
```

æˆ‘ä»¬å†çœ‹ä¸€ä¸‹ä¸¤ä¸ªä»»åŠ¡çš„æ¨¡æ‹Ÿè€—æ—¶ï¼š

- `FileReaderPlugin`: è€—æ—¶ 1 ç§’
- `FileArchiverPlugin`: è€—æ—¶ 0.5 ç§’
- æ•´ä¸ªè¿‡ç¨‹è€—æ—¶ 1.5 ç§’ï¼ˆ1s + 0.5sï¼‰

::: details æ‰“å°é¡ºåº

```
å‡†å¤‡å¼€å§‹å¤„ç†æ–‡ä»¶...
å¼€å§‹è¯»å– styles.css...
styles.css è¯»å–å®Œæ¯•ï¼
å¼€å§‹å‹ç¼© styles.css...
styles.css å‹ç¼©å®Œæ¯•ï¼
æ‰€æœ‰æ–‡ä»¶å¤„ç†ä»»åŠ¡å·²å…¨éƒ¨å®Œæˆï¼
```

:::

ç°åœ¨ï¼Œæ€è€ƒä¸€ä¸ªé—®é¢˜ï¼šå¦‚æœè¯»å–å’Œå‹ç¼©è¿™ä¸¤ä¸ªæ“ä½œäº’ä¸ä¾èµ–ï¼Œæˆ‘ä»¬æœ‰æ²¡æœ‰åŠæ³•è®©å®ƒä»¬**åŒæ—¶è¿›è¡Œ**æ¥èŠ‚çœæ—¶é—´å‘¢ï¼Ÿ

å½“ç„¶æœ‰ï¼è¿™å°±æ˜¯ `AsyncParallelHook` çš„ç”¨æ­¦ä¹‹åœ°ã€‚

#### 3.3.2 AsyncParallelHook

"Parallel" **å°±æ˜¯"å¹¶è¡Œ"çš„æ„æ€**ã€‚å®ƒçš„è§„åˆ™å’Œ `AsyncSeriesHook` å¾ˆåƒï¼Œä¹Ÿéœ€è¦è°ƒç”¨ `callback`ï¼Œ**ä½†å®ƒä¼šä¸€æ¬¡æ€§å¯åŠ¨æ‰€æœ‰ä»»åŠ¡**ï¼Œç„¶åç­‰å¾…æ‰€æœ‰ä»»åŠ¡éƒ½è°ƒç”¨äº† `callback` ä¹‹åï¼Œ**å†æ‰§è¡Œæœ€åçš„å¤§å›è°ƒ**ã€‚

æœ€å…³é”®çš„ä¸€ç‚¹æ˜¯ï¼Œ**æ•´ä¸ªè¿‡ç¨‹çš„æ€»è€—æ—¶å¤§çº¦æ˜¯ 1 ç§’ï¼ˆå–å†³äºæœ€æ…¢çš„é‚£ä¸ªä»»åŠ¡ï¼‰**ï¼Œè€Œä¸æ˜¯ `AsyncSeriesHook` çš„ 1.5 ç§’ã€‚é€šè¿‡å¹¶è¡Œæ‰§è¡Œï¼Œæˆ‘ä»¬èŠ‚çœäº†æ—¶é—´ï¼

```js
// æ³¨æ„ï¼Œè¿™æ¬¡æˆ‘ä»¬ç”¨ AsyncParallelHook
const { AsyncParallelHook } = require("tapable");

const fileProcessingHook = new AsyncParallelHook(["file"]);

console.log("å‡†å¤‡å¼€å§‹å¹¶è¡Œå¤„ç†æ–‡ä»¶...");

fileProcessingHook.tapAsync("FileReaderPlugin", (file, callback) => {
  console.log(`å¼€å§‹è¯»å– ${file}...`);
  setTimeout(() => {
    console.log(`${file} è¯»å–å®Œæ¯•ï¼`);
    callback();
  }, 1000); // è€—æ—¶ 1 ç§’
});

fileProcessingHook.tapAsync("FileArchiverPlugin", (file, callback) => {
  console.log(`å¼€å§‹å‹ç¼© ${file}...`);
  setTimeout(() => {
    console.log(`${file} å‹ç¼©å®Œæ¯•ï¼`);
    callback();
  }, 500); // è€—æ—¶ 0.5 ç§’
});

fileProcessingHook.callAsync("styles.css", () => {
  console.log("æ‰€æœ‰å¹¶è¡Œä»»åŠ¡å·²å…¨éƒ¨å®Œæˆï¼");
});
```

::: details æ‰“å°é¡ºåº

```
å‡†å¤‡å¼€å§‹å¤„ç†æ–‡ä»¶...
å¼€å§‹è¯»å– styles.css...
å¼€å§‹å‹ç¼© styles.css...
styles.css å‹ç¼©å®Œæ¯•ï¼
styles.css è¯»å–å®Œæ¯•ï¼
æ‰€æœ‰æ–‡ä»¶å¤„ç†ä»»åŠ¡å·²å…¨éƒ¨å®Œæˆï¼
```

:::

æˆ‘ä»¬å†è¯•è¯•å°†å›è°ƒå‡½æ•°æ›´æ”¹æˆå¦ä¸€ç§å†™æ³• **Promise**ï¼š

1. è®¢é˜…æ—¶ä½¿ç”¨ `.tapPromise()`
2. è¢«è®¢é˜…çš„å‡½æ•°ä¸å†æ¥æ”¶ `callback`ï¼Œè€Œæ˜¯éœ€è¦**è¿”å›ä¸€ä¸ª `Promise`**ï¼Œå½“ä½ çš„å¼‚æ­¥ä»»åŠ¡å®Œæˆæ—¶ï¼Œä½ è¦è°ƒç”¨ `Promise` çš„ `resolve` æ–¹æ³•
3. è§¦å‘æ—¶ä½¿ç”¨ `.promise()`ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ª `Promise`ã€‚ä½ å¯ä»¥åœ¨è¿™ä¸ª `Promise` åé¢ä½¿ç”¨ `.then()` æ¥æ‰§è¡Œæ‰€æœ‰ä»»åŠ¡éƒ½å®Œæˆåçš„æœ€ç»ˆé€»è¾‘

```js
const { AsyncParallelHook } = require("tapable");

const fileProcessingHook = new AsyncParallelHook(["file"]);

console.log("å‡†å¤‡å¼€å§‹å¹¶è¡Œå¤„ç†æ–‡ä»¶ (Promise é£æ ¼)...");

// 1. ä½¿ç”¨ tapPromise è®¢é˜…
fileProcessingHook.tapPromise("FileReaderPlugin", (file) => {
  // 2. è¿”å›ä¸€ä¸ª new Promise
  return new Promise(resolve => {
    console.log(`å¼€å§‹è¯»å– ${file}...`);
    setTimeout(() => {
      console.log(`${file} è¯»å–å®Œæ¯•ï¼`);
      resolve(); // <-- å¼‚æ­¥ä»»åŠ¡å®Œæˆï¼Œè°ƒç”¨ resolve
    }, 1000);
  });
});

fileProcessingHook.tapPromise("FileArchiverPlugin", (file) => {
  return new Promise(resolve => {
    console.log(`å¼€å§‹å‹ç¼© ${file}...`);
    setTimeout(() => {
      console.log(`${file} å‹ç¼©å®Œæ¯•ï¼`);
      resolve(); // <-- å¼‚æ­¥ä»»åŠ¡å®Œæˆï¼Œè°ƒç”¨ resolve
    }, 500);
  });
});

// 3. ä½¿ç”¨ .promise() è§¦å‘ï¼Œå¹¶åœ¨ .then() ä¸­å¤„ç†æœ€ç»ˆå›è°ƒ
fileProcessingHook.promise("styles.css").then(() => {
  console.log("æ‰€æœ‰å¹¶è¡Œä»»åŠ¡å·²å…¨éƒ¨å®Œæˆï¼");
});
```

è¿™æ®µä»£ç çš„æœ€ç»ˆè¾“å‡ºé¡ºåºå’Œæ€»è€—æ—¶ï¼Œè·Ÿä¸Šä¸€ä¸ª `tapAsync` çš„ä¾‹å­æ˜¯**ä¸€æ¨¡ä¸€æ ·**çš„ã€‚

#### 3.3.3 AsyncSeriesBailHook

å®ƒç»“åˆäº† **ä¸²è¡Œæ‰§è¡Œ** å’Œ **ç†”æ–­ï¼ˆBailï¼‰æœºåˆ¶** çš„ç‰¹ç‚¹ã€‚

**æ ¸å¿ƒæ¦‚å¿µï¼š**

1. **ä¸²è¡Œæ‰§è¡Œï¼ˆAsyncSeriesï¼‰**
   - æ‰€æœ‰æ³¨å†Œçš„å›è°ƒå‡½æ•°ï¼ˆ`tapAsync/tapPromise`ï¼‰ä¼šè¢« **æŒ‰é¡ºåºå¯åŠ¨æ‰§è¡Œ**ï¼ˆé˜»å¡ï¼‰ï¼Œéœ€è¦ç­‰å¾…å‰ä¸€ä¸ªå›è°ƒå®Œæˆ

2. **ç†”æ–­æœºåˆ¶ï¼ˆBailï¼‰**
   - æŒ‰ç…§æ‰§è¡Œé¡ºåºæ‰§è¡Œï¼Œå‡½æ•°è¿”å›ä¸€ä¸ª**é undefined** ç›´æ¥**è¿›è¡Œç†”æ–­**

**ç¤ºä¾‹ï¼š**

å¯ä»¥çœ‹åˆ°é¦–å…ˆæ‰§è¡Œ `AsyncSeriesBailHook1` è¿™ä¸ªå‡½æ•°ï¼Œ**æŒ‰ç…§é¡ºåºæ‰§è¡Œ**ï¼Œè€—æ—¶ 3sï¼Œæœ€ç»ˆè¿”å›äº†ä¸€ä¸ª**é undefined å€¼**ç«‹å³è¿›è¡Œç†”æ–­äº†ã€‚æ­¤æ—¶å¯ä»¥çœ‹åˆ° `res` è¿”å›**å¾—åˆ°å€¼æ˜¯ 1**ã€‚

å¦‚æœ `AsyncSeriesBailHook1` è¿”å›å€¼æ˜¯ä¸€ä¸ª **undefined å‘¢ï¼Ÿ** é‚£ä¹ˆæœ€ç»ˆä¼šæ‰§è¡Œ `AsyncSeriesBailHook2` ç„¶åè¿”å› 2ï¼Œ`res` æœ€ç»ˆå¾—åˆ°å€¼ä¹Ÿå˜æˆ 2ã€‚

```js
const tapable = require('tapable');

class Compiler {
  constructor() {
    this.hooks = {
      AsyncSeriesBailHook: new tapable.AsyncSeriesBailHook(['name', 'age']),
    };
  }
}

const c = new Compiler();

c.hooks.AsyncSeriesBailHook.tapPromise('AsyncSeriesBailHook1', (name, age) => {
  return new Promise((resolve) => {
    setTimeout(() => {
      resolve(1); // å¾—åˆ° 1  é undefinedç›´æ¥è¿›è¡Œç†”æ–­
    }, 3000);
  });
});
c.hooks.AsyncSeriesBailHook.tapPromise('AsyncSeriesBailHook2', (name, age) => {
  return new Promise((resolve) => {
    setTimeout(() => {
      resolve(2);
    }, 2000);
  });
});
c.hooks.AsyncSeriesBailHook.tapPromise('AsyncSeriesBailHook3', (name, age) => {
  return new Promise((resolve) => {
    setTimeout(() => {
      resolve(3);
    }, 500);
  });
});
c.hooks.AsyncSeriesBailHook.promise('zhangsan', 20).then((res) => {
  console.log('res', res);
});
```

#### 3.3.4 AsyncParallelBailHook

è¿™ä¸ªç¨å¾®æ¯”åˆšåˆš `AsyncSeriesBailHook` è¿™ä¸ª hook è¦éš¾ä»¥ç†è§£ä¸€ç‚¹ï¼Œå› ä¸ºå®ƒæ˜¯**å¹¶è¡Œç†”æ–­**ã€‚

**æ ¸å¿ƒæ¦‚å¿µï¼š**

1. **å¹¶è¡Œæ‰§è¡Œï¼ˆAsyncParallelï¼‰**
   - æ‰€æœ‰æ³¨å†Œçš„å›è°ƒå‡½æ•°ï¼ˆtap/tapAsync/tapPromiseï¼‰ä¼šè¢« **åŒæ—¶å¯åŠ¨æ‰§è¡Œ**ï¼ˆéé˜»å¡ï¼‰ï¼Œä¸ç­‰å¾…å‰ä¸€ä¸ªå›è°ƒå®Œæˆ

2. **ç†”æ–­æœºåˆ¶ï¼ˆBailï¼‰**
   - ç†”æ–­æœºåˆ¶**è¿˜æ˜¯å­˜åœ¨é¡ºåº**ï¼Œå‡å¦‚ a å‡½æ•°åœ¨ b å‡½æ•°å‰é¢ï¼Œ**è™½ç„¶ a å‡½æ•°å› ä¸ºä»»åŠ¡è€—æ—¶æ—¶é—´æ¯” b å‡½æ•°è€—æ—¶æ—¶é—´æ›´é•¿**ï¼Œä½†æ˜¯åœ¨ç†”æ–­æœºåˆ¶é‡Œé¢ï¼Œa è¿”å›ä¸€ä¸ª**é undefined çš„å€¼**ï¼Œé‚£ä¹ˆè¿”å›çš„å€¼å°±æ˜¯ a è¿”å›çš„

**ç¤ºä¾‹åˆ†æï¼š**

æ­¤æ—¶ `result` è¿™ä¸ªå›è°ƒè¿”å›çš„å€¼æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ

è¿™ä¸ªæ˜¯å¹¶è¡Œçš„ï¼Œæ‰€æœ‰ä»»åŠ¡éƒ½åŒæ—¶æ‰§è¡Œï¼Œè¿™ä¸ªæ—¶å€™ `AsyncParallelBailHook3` å…ˆæ‰§è¡Œå®Œæˆï¼Œå®ƒè¿”å›äº†ä¸€ä¸ª**é undefined å€¼**ï¼Œç„¶åç†”æ–­æœºåˆ¶ï¼Œæœ€ç»ˆæ˜¯ `AsyncParallelBailHook3` å®ƒçš„è¿”å›å€¼å—ï¼Ÿ

å…¶å®ä¸æ˜¯ï¼Œè™½ç„¶ `AsyncParallelBailHook3` å…ˆæ‰§è¡Œå®Œæˆï¼Œä½†æ˜¯ä¹Ÿéœ€è¦çœ‹**å‡½æ•°å®šä¹‰çš„ä½ç½®**ï¼Œæ­¤æ—¶æˆ‘ä»¬è™½ç„¶çœ‹åˆ° `AsyncParallelBailHook1` ä»»åŠ¡æ˜¯æœ€è€—æ—¶çš„ï¼Œä½†æ˜¯å› ä¸ºå®ƒå‡½æ•°å®šä¹‰ä½ç½®åœ¨**é¦–ä½å¹¶ä¸”å®ƒè¿”å›å€¼åˆæ˜¯ä¸€ä¸ªé undefined çš„å€¼**ï¼Œæ‰€ä»¥æœ€ç»ˆ `result` è¿”å›å€¼æ˜¯ `AsyncParallelBailHook1` å‡½æ•°è¿”å›çš„ã€‚

**æé—®ï¼š** å¦‚æœ `AsyncParallelBailHook1` è¿”å›çš„æ˜¯ undefinedï¼Œè¯·é—® result æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæ˜¯å‡½æ•° `AsyncParallelBailHook2` è¿”å›çš„å€¼ã€‚

```js
const tabable = require('tapable');

class Tabable {
  constructor() {
    this.hooks = {
      // åˆ›å»ºä¸€ä¸ªæ–°çš„ AsyncParallelBailHook å®ä¾‹
      AsyncParallelBailHook: new tabable.AsyncParallelBailHook(['name', 'age']),
    };
  }
}
const useTapable = new Tabable();

useTapable.hooks.AsyncParallelBailHook.tapAsync('AsyncParallelBailHook1', (name, age, callback) => {
  setTimeout(() => {
    callback(null, { name: 'zs', age });
  }, 1000);
});
useTapable.hooks.AsyncParallelBailHook.tapAsync('AsyncParallelBailHook2', (name, age, callback) => {
  setTimeout(() => {
    callback(null, { name: 'ls', age });
  }, 800);
});
useTapable.hooks.AsyncParallelBailHook.tapAsync('AsyncParallelBailHook3', (name, age, callback) => {
  setTimeout(() => {
    callback(null, { name: 'ww', age });
  }, 500);
});

const a = useTapable.hooks.AsyncParallelBailHook.callAsync('zhangsan', 20, (err, result) => {
  console.log('end', result);
});
```

#### 3.3.5 AsyncWaterfallHook

å®ƒçš„ä½¿ç”¨æ–¹å¼è·Ÿ `SyncWaterfallHook`ï¼ˆåŒæ­¥ç€‘å¸ƒï¼‰ç›¸ä¼¼ï¼Œæœ‰ä¸€è¿ä¸²çš„**å¼‚æ­¥ä»»åŠ¡**ï¼Œ**å®ƒä»¬å¿…é¡»æŒ‰é¡ºåºæ‰§è¡Œï¼Œå¹¶ä¸”ä¸‹ä¸€ä¸ªä»»åŠ¡éœ€è¦ä¸Šä¸€ä¸ªä»»åŠ¡çš„ç»“æœæ‰èƒ½å¼€å§‹**ã€‚

æƒ³è±¡ä¸€ä¸ªæµç¨‹ï¼š

1. å…ˆé€šè¿‡ä¸€ä¸ªå¼‚æ­¥è¯·æ±‚ï¼Œç”¨ç”¨æˆ·åæ¢å–ç”¨æˆ· ID
2. å†ç”¨è¿™ä¸ª IDï¼Œé€šè¿‡å¦ä¸€ä¸ªå¼‚æ­¥è¯·æ±‚ï¼Œè·å–ç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯
3. æœ€åç”¨è¯¦ç»†ä¿¡æ¯ï¼Œå»è¯·æ±‚è¿™ä¸ªç”¨æˆ·çš„æœ€æ–°æ–‡ç« åˆ—è¡¨

**ç‰¹ç‚¹ï¼š** "å¼‚æ­¥ç€‘å¸ƒ"é’©å­ã€‚ä¸Šä¸€ä¸ªæŒ‚è½½å‡½æ•°çš„**è¿”å›å€¼ä¼šä½œä¸ºä¸‹ä¸€ä¸ªå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°**ã€‚ç¬¬ä¸€ä¸ªæŒ‚è½½å‡½æ•°çš„å‚æ•°ç”± `.callAsync/promise` æ–¹æ³•ä¼ å…¥ã€‚

```js
const { AsyncWaterfallHook } = require("tapable");

const userDataHook = new AsyncWaterfallHook(["username"]);

console.log("å¼€å§‹è·å–ç”¨æˆ·æ•°æ®æµæ°´çº¿...");

// ç¬¬ä¸€ä¸ªæ’ä»¶ï¼šç”¨ username è·å– id
userDataHook.tapPromise("GetIdPlugin", (username) => {
  return new Promise(resolve => {
    console.log("1. GetIdPlugin: å¼€å§‹è·å– ID...");
    setTimeout(() => {
      const userId = `id_${username}`;
      console.log(`1. GetIdPlugin: æˆåŠŸè·å– ID: ${userId}`);
      resolve(userId); // <-- æŠŠ userId ä¼ é€’ä¸‹å»
    }, 500);
  });
});

// ç¬¬äºŒä¸ªæ’ä»¶ï¼šç”¨ id è·å– profile
userDataHook.tapPromise("GetProfilePlugin", (userId) => {
  // `userId` æ˜¯ä¸Šä¸€æ­¥ resolve å‡ºæ¥çš„å€¼
  return new Promise(resolve => {
    console.log("2. GetProfilePlugin: å¼€å§‹è·å–ä¸ªäººä¿¡æ¯...");
    setTimeout(() => {
      const profile = { id: userId, name: "Alice", age: 30 };
      console.log("2. GetProfilePlugin: æˆåŠŸè·å–ä¸ªäººä¿¡æ¯ï¼");
      resolve(profile); // <-- æŠŠ profile å¯¹è±¡ä¼ é€’ä¸‹å»
    }, 500);
  });
});

// ç¬¬ä¸‰ä¸ªæ’ä»¶ï¼šç”¨ profile è·å– posts
userDataHook.tapPromise("GetPostsPlugin", (profile) => {
  // `profile` æ˜¯ä¸Šä¸€æ­¥ resolve å‡ºæ¥çš„å€¼
  return new Promise(resolve => {
    console.log("3. GetPostsPlugin: å¼€å§‹è·å–æ–‡ç« åˆ—è¡¨...");
    setTimeout(() => {
      profile.posts = ["Post A", "Post B"];
      console.log("3. GetPostsPlugin: æˆåŠŸè·å–æ–‡ç« åˆ—è¡¨ï¼");
      resolve(profile); // <-- æŠŠæœ€ç»ˆçš„ profile å¯¹è±¡ä¼ é€’ä¸‹å»
    }, 500);
  });
});

// è§¦å‘é’©å­ï¼Œæ¥æ”¶æœ€ç»ˆçš„ç»“æœ
userDataHook.promise("alice123").then(finalResult => {
  console.log("\n---- æ•°æ®æµæ°´çº¿å…¨éƒ¨å®Œæˆ ----");
  console.log("æœ€ç»ˆç»“æœ:", finalResult);
});
```

::: details æ‰“å°ç»“æœ

```json
{
  "id": "id_alice123",
  "name": "Alice",
  "age": 30,
  "posts": [
    "Post A",
    "Post B"
  ]
}
```

:::

## 4. æ€»ç»“

é€šè¿‡å¯¹ `tapable` çš„å­¦ä¹ ï¼Œæˆ‘ä»¬äº†è§£äº†ï¼š

**æ ¸å¿ƒæ¦‚å¿µï¼š** é’©å­ï¼ˆHooksï¼‰ã€æŒ‚è½½ï¼ˆTappingï¼‰ã€è°ƒç”¨ï¼ˆCallingï¼‰æ˜¯ `tapable` çš„ä¸‰å¤§æ ¸å¿ƒæ¦‚å¿µã€‚

**åŒæ­¥é’©å­ï¼š** åŒ…æ‹¬ `SyncHook`ã€`SyncBailHook`ã€`SyncWaterfallHook`ã€`SyncLoopHook`ï¼Œåˆ†åˆ«å¯¹åº”ä¸åŒçš„æ‰§è¡Œç­–ç•¥ã€‚

**å¼‚æ­¥é’©å­ï¼š** åŒ…æ‹¬ `AsyncSeriesHook`ï¼ˆä¸²è¡Œï¼‰ã€`AsyncParallelHook`ï¼ˆå¹¶è¡Œï¼‰ã€`AsyncSeriesBailHook`ï¼ˆä¸²è¡Œç†”æ–­ï¼‰ã€`AsyncParallelBailHook`ï¼ˆå¹¶è¡Œç†”æ–­ï¼‰ã€`AsyncWaterfallHook`ï¼ˆå¼‚æ­¥ç€‘å¸ƒï¼‰ï¼Œæä¾›äº†ä¸°å¯Œçš„å¼‚æ­¥å¤„ç†èƒ½åŠ›ã€‚

**å®é™…åº”ç”¨ï¼š** `Webpack` çš„æ’ä»¶ç³»ç»Ÿæ­£æ˜¯åŸºäº `tapable` æ„å»ºçš„ï¼Œç†è§£è¿™äº›é’©å­ç±»å‹å¯¹äºå¼€å‘é«˜è´¨é‡çš„ `Webpack` æ’ä»¶è‡³å…³é‡è¦ã€‚

é€šè¿‡æŒæ¡ `tapable`ï¼Œä½ å°†èƒ½å¤Ÿæ›´å¥½åœ°ç†è§£ `Webpack` çš„å·¥ä½œåŸç†ï¼Œå¹¶èƒ½å¤Ÿç¼–å†™å‡ºæ›´åŠ å¼ºå¤§å’Œçµæ´»çš„æ’ä»¶æ¥æ‰©å±• `Webpack` çš„åŠŸèƒ½ã€‚

> [â¡ï¸å®Œæ•´æ¡ˆåˆ—ä»£ç ](https://github.com/webBocai/webpack-/tree/main/%E8%87%AA%E5%AE%9A%E4%B9%89plguin/%E8%AE%A4%E8%AF%86tapable)  